<!doctype html> <html lang="en"> <head><meta http-equiv="Content-Type" content="text/html" charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"><title>Announcing the New Raptor Templates! | Patrick Steele-Idem</title><link rel="alternate" type="application/rss+xml" title="RSS" href="/rss.xml"><meta name="description" content="Web Development, JavaScript, Node.js and open source software."><link href="/favicon.ico" rel="icon"><meta name="HandheldFriendly" content="True"><meta name="MobileOptimized" content="320"><meta name="viewport" content="initial-scale=1,user-scalable=no,maximum-scale=1,width=device-width"><link rel="stylesheet" type="text/css" href="/static/post-7247e57d.css">
<link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.css"></head><body><div id="header-bg"></div><div id="nav-bg"></div><div id="content"><header id="header"><div id="titles"><h1><a href="/">Patrick Steele-Idem</a></h1><h2>Better WebDev</h2></div></header><nav role="navigation" id="nav"><ul class="main-navigation"><li><a href="/">Blog</a></li><li><a href="/archive/">Archive</a></li><li><a href="/about/">About</a></li><li><a href="/subscribe/">Subscribe</a></li><li><form action="https://google.com/search" method="get" class="search-form"><fieldset role="search"><input type="hidden" name="q" value="site:http://psteeleidem.com/"><input type="text" name="q" results="0" placeholder="Search" class="search-input"></fieldset></form></li></ul></nav><main id="main"><div class="draft"><i class="fa fa-exclamation-circle"></i> Draft</div><article class="hentry" role="article"><h1 class="post-title">Announcing the New Raptor Templates!</h1><div class="post-meta"><span class="byline author vcard">Posted by <span class="fn">Patrick Steele-Idem</span></span> on <time data-updated="true" pubdate="" datetime="2014-05-05">Monday, May 5th, 2014</time> <span class="categories">&nbsp; <nobr><i class="fa fa-tags"></i> <a href="/category/javascript/" class="category">JavaScript</a>, <a href="/category/raptor-templates/" class="category">Raptor Templates</a>, <a href="/category/templating/" class="category">Templating</a></nobr></span></div><div class="post-body"><p>We are excited to announce the release of the <em>new</em> <a href="https://github.com/raptorjs3/raptor-templates">Raptor Templates</a>! Earlier this year, we undertook the task of making substantial usability improvements to the Raptor Templates language and API based on the feedback that we had received. We also took the opportunity to make significant performance improvements and now the runtime and compiled templates are much leaner and faster as a result.</p>
<p>Fundamentally, the language has remained the same. However, we have taken away many of the problems that introduced friction such as the use of XML and compatibility problems with Node.js due to the use of AMD.</p>
<p><p class="toc"><strong>Table of Contents</strong><ul class="toc-level0"><li><a href="#summary-of-changes">Summary of Changes</a></li><li><a href="#change-details">Change Details</a><ul class="toc-level1"><li><a href="#separated-out-raptor-templates-into-a-separate-top-level-module">Separated out Raptor Templates into a separate, top-level module:</a></li><li><a href="#switched-from-xml-to-html">Switched from XML to HTML</a></li><li><a href="#simplified-javascript-api">Simplified JavaScript API</a></li><li><a href="#improved-streaming-support">Improved streaming support</a></li><li><a href="#introduced-directory-scanning-for-easier-taglib-maintenance">Introduced directory scanning for easier taglib maintenance</a></li><li><a href="#switched-from-xml-to-json-for-taglibs">Switched from XML to JSON for taglibs</a></li><li><a href="#simplified-asynchronous-api">Simplified asynchronous API</a></li></ul></li></ul></p></p>
<h2 id="summary-of-changes"><a name="summary-of-changes" class="anchor" href="#summary-of-changes"><span class="header-link"></span></a>Summary of Changes</h2><p>Here&#39;s a summary of the changes in this new major release:</p>
<ul>
<li>Code cleaned up and reorganized<ul>
<li>Split out Raptor Templates into its own top-level module: <a href="https://www.npmjs.org/package/raptor-templates">raptor-templates</a></li>
<li>Moved documentation into <a href="https://github.com/raptorjs3/raptor-templates/blob/master/README.md">README.md</a></li>
<li>Significant reduction in code size</li>
<li>Flattened the directory structure</li>
</ul>
</li>
<li>Switched from an XML parser to an <a href="https://github.com/fb55/htmlparser2">HTML parser</a><ul>
<li>Dropped the root <code>&lt;c:template&gt;</code> tag</li>
<li>Taglibs no longer have to be imported (no more <code>xmlns</code>)</li>
<li>Dropped support for the <code>params</code> attribute</li>
<li>Dropped namespaces in favor of dash separated names</li>
</ul>
</li>
<li>Switched to CommonJS modules everywhere<ul>
<li>Switched from AMD to CommonJS for the runtime</li>
<li>Templates now compile down to CommonJS modules for better integration with Node.js (no named templates!)</li>
<li>Designed to support Node.js and Node.js module bundlers</li>
</ul>
</li>
<li>Simplified the JavaScript API<ul>
<li>Templates can now be easily loaded to get back an object with a <code>render</code> method</li>
<li>Improved streaming support</li>
<li>Simplified the asynchronous rendering API</li>
</ul>
</li>
<li>Simplified taglibs<ul>
<li>Switched from XML to JSON for taglibs</li>
<li>Custom tags and custom attributes must have a dash in the name</li>
<li>Taglibs automatically discovered based on template location</li>
<li>Taglibs installed via <code>npm</code> will automatically be discovered</li>
<li>Added support for directory scanning for automatic taglibs</li>
<li>Custom tag renderers now referenced by relative path</li>
<li>Custom tag attribute definitions are now optional</li>
<li>Custom tag definition can be put into the renderer&#39;s JavaScript file instead of in a separate file</li>
</ul>
</li>
<li>Miscellaneous<ul>
<li>Node.js modules can be imported into templates for use as helpers</li>
<li>Introduced a simple and powerful command-line compiler: <a href="https://github.com/raptorjs3/raptor-templates#template-compilation">rhtmlc</a></li>
<li>Improved performance now far exceeds the competition! Please see <a href="https://github.com/raptorjs3/templating-benchmarks">benchmarks</a>.</li>
</ul>
</li>
</ul>
<h2 id="change-details"><a name="change-details" class="anchor" href="#change-details"><span class="header-link"></span></a>Change Details</h2><h3 id="separated-out-raptor-templates-into-a-separate-top-level-module"><a name="separated-out-raptor-templates-into-a-separate-top-level-module" class="anchor" href="#separated-out-raptor-templates-into-a-separate-top-level-module"><span class="header-link"></span></a>Separated out Raptor Templates into a separate, top-level module:</h3><pre><code class="lang-bash">npm install raptor-templates
</code></pre>
<p>Project links:</p>
<ul>
<li>Github: <a href="https://github.com/raptorjs3/raptor-templates">https://github.com/raptorjs3/raptor-templates</a></li>
<li>npm: <a href="https://www.npmjs.org/package/raptor-templates">https://www.npmjs.org/package/raptor-templates</a></li>
</ul>
<h3 id="switched-from-xml-to-html"><a name="switched-from-xml-to-html" class="anchor" href="#switched-from-xml-to-html"><span class="header-link"></span></a>Switched from XML to HTML</h3><p><strong>OLD:</strong></p>
<pre><code class="lang-xml"><span class="hljs-tag">&lt;<span class="hljs-title">c:template</span> <span class="hljs-attribute">xmlns:c</span>=<span class="hljs-value">"core"</span> 
    <span class="hljs-attribute">xmlns:app</span>=<span class="hljs-value">"app"</span>
    <span class="hljs-attribute">params</span>=<span class="hljs-value">"name,colors"</span>&gt;</span>

    Hello $name!

    <span class="hljs-tag">&lt;<span class="hljs-title">app:button</span> <span class="hljs-attribute">label</span>=<span class="hljs-value">"Hello World"</span>/&gt;</span>

    <span class="hljs-tag">&lt;<span class="hljs-title">ul</span> <span class="hljs-attribute">c:if</span>=<span class="hljs-value">"notEmpty(colors)"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-title">li</span> <span class="hljs-attribute">style</span>=<span class="hljs-value">"color: $color"</span> <span class="hljs-attribute">c:for</span>=<span class="hljs-value">"color in colors"</span>&gt;</span>
            $color
        <span class="hljs-tag">&lt;/<span class="hljs-title">li</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-title">ul</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">div</span> <span class="hljs-attribute">c:else</span>=<span class="hljs-value">""</span>&gt;</span>
        No colors!
    <span class="hljs-tag">&lt;/<span class="hljs-title">div</span>&gt;</span>

<span class="hljs-tag">&lt;/<span class="hljs-title">c:template</span>&gt;</span>
</code></pre>
<p><strong>NEW:</strong></p>
<pre><code class="lang-html">Hello $data.name!

<span class="hljs-tag">&lt;<span class="hljs-title">app-button</span> <span class="hljs-attribute">label</span>=<span class="hljs-value">"Hello World"</span>/&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-title">ul</span> <span class="hljs-attribute">c-if</span>=<span class="hljs-value">"notEmpty(data.colors)"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">li</span> <span class="hljs-attribute">style</span>=<span class="hljs-value">"color: $color"</span> <span class="hljs-attribute">c-for</span>=<span class="hljs-value">"color in data.colors"</span>&gt;</span>
        $color
    <span class="hljs-tag">&lt;/<span class="hljs-title">li</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-title">ul</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-title">div</span> <span class="hljs-attribute">c-else</span>&gt;</span>
    No colors!
<span class="hljs-tag">&lt;/<span class="hljs-title">div</span>&gt;</span>
</code></pre>
<h3 id="simplified-javascript-api"><a name="simplified-javascript-api" class="anchor" href="#simplified-javascript-api"><span class="header-link"></span></a>Simplified JavaScript API</h3><pre><code class="lang-javascript"><span class="hljs-keyword">var</span> template = <span class="hljs-built_in">require</span>(<span class="hljs-string">'raptor-templates'</span>).load(<span class="hljs-string">'hello.rhtml'</span>);

template.render({
        name: <span class="hljs-string">'World'</span>,
        colors: [<span class="hljs-string">"red"</span>, <span class="hljs-string">"green"</span>, <span class="hljs-string">"blue"</span>]
    },
    <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(err, output)</span> {</span>
        console.log(output);
    });
</code></pre>
<h3 id="improved-streaming-support"><a name="improved-streaming-support" class="anchor" href="#improved-streaming-support"><span class="header-link"></span></a>Improved streaming support</h3><pre><code class="lang-javascript"><span class="hljs-keyword">var</span> template = <span class="hljs-built_in">require</span>(<span class="hljs-string">'raptor-templates'</span>).load(<span class="hljs-string">'hello.rhtml'</span>);

template.stream(data)
    .pipe();
</code></pre>
<h3 id="introduced-directory-scanning-for-easier-taglib-maintenance"><a name="introduced-directory-scanning-for-easier-taglib-maintenance" class="anchor" href="#introduced-directory-scanning-for-easier-taglib-maintenance"><span class="header-link"></span></a>Introduced directory scanning for easier taglib maintenance</h3><p>Please see <a href="https://github.com/raptorjs3/raptor-templates#scanning-for-tags">Scanning for Tags</a></p>
<h3 id="switched-from-xml-to-json-for-taglibs"><a name="switched-from-xml-to-json-for-taglibs" class="anchor" href="#switched-from-xml-to-json-for-taglibs"><span class="header-link"></span></a>Switched from XML to JSON for taglibs</h3><p><strong>Old taglib:</strong></p>
<p><code>rebootstrap.rtld</code></p>
<pre><code class="lang-xml"><span class="hljs-tag">&lt;<span class="hljs-title">raptor-taglib</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">uri</span>&gt;</span>rebootstrap<span class="hljs-tag">&lt;/<span class="hljs-title">uri</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">import-taglib</span> <span class="hljs-attribute">path</span>=<span class="hljs-value">"rebootstrap/ui/components/buttons/Button/Button.rtld"</span>/&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-title">raptor-taglib</span>&gt;</span>
</code></pre>
<p><code>./ui-components/buttons/Button/Button.rtld</code></p>
<pre><code class="lang-xml"><span class="hljs-tag">&lt;<span class="hljs-title">raptor-taglib</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">tag</span> <span class="hljs-attribute">name</span>=<span class="hljs-value">"button"</span> <span class="hljs-attribute">renderer</span>=<span class="hljs-value">"rebootstrap/ui/components/buttons/Button/ButtonRenderer"</span> <span class="hljs-attribute">dynamic-attributes</span>=<span class="hljs-value">"true"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-title">attribute</span> <span class="hljs-attribute">name</span>=<span class="hljs-value">"id"</span> <span class="hljs-attribute">type</span>=<span class="hljs-value">"string"</span>/&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-title">attribute</span> <span class="hljs-attribute">name</span>=<span class="hljs-value">"label"</span> <span class="hljs-attribute">type</span>=<span class="hljs-value">"string"</span>/&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-title">attribute</span> <span class="hljs-attribute">name</span>=<span class="hljs-value">"href"</span> <span class="hljs-attribute">type</span>=<span class="hljs-value">"string"</span>/&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-title">attribute</span> <span class="hljs-attribute">name</span>=<span class="hljs-value">"variant"</span> <span class="hljs-attribute">type</span>=<span class="hljs-value">"string"</span> <span class="hljs-attribute">description</span>=<span class="hljs-value">"primary | info | success | warning | danger | inverse"</span>/&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-title">attribute</span> <span class="hljs-attribute">name</span>=<span class="hljs-value">"size"</span> <span class="hljs-attribute">type</span>=<span class="hljs-value">"string"</span> <span class="hljs-attribute">description</span>=<span class="hljs-value">"large | small | mini"</span>/&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-title">attribute</span> <span class="hljs-attribute">name</span>=<span class="hljs-value">"toggle"</span> <span class="hljs-attribute">type</span>=<span class="hljs-value">"boolean"</span>/&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-title">attribute</span> <span class="hljs-attribute">name</span>=<span class="hljs-value">"toggled"</span> <span class="hljs-attribute">type</span>=<span class="hljs-value">"boolean"</span>/&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-title">attribute</span> <span class="hljs-attribute">name</span>=<span class="hljs-value">"dropdown"</span> <span class="hljs-attribute">type</span>=<span class="hljs-value">"boolean"</span>/&gt;</span>

        <span class="hljs-comment">&lt;!-- Support widget attributes --&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-title">attribute</span> <span class="hljs-attribute">name</span>=<span class="hljs-value">"id"</span> <span class="hljs-attribute">uri</span>=<span class="hljs-value">"widgets"</span>/&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-title">attribute</span> <span class="hljs-attribute">name</span>=<span class="hljs-value">"event-click"</span> <span class="hljs-attribute">uri</span>=<span class="hljs-value">"widgets"</span>/&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-title">tag</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-title">raptor-taglib</span>&gt;</span>
</code></pre>
<p><strong>New taglib:</strong></p>
<p><code>raptor-taglib.json</code></p>
<pre><code class="lang-json">{
    "<span class="hljs-attribute">tags</span>": <span class="hljs-value">{
        "<span class="hljs-attribute">app-button</span>": <span class="hljs-value"><span class="hljs-string">"./ui-components/buttons/Button/raptor-tag.json"</span></span>,
        "<span class="hljs-attribute">app-hello</span>": <span class="hljs-value">{
            "<span class="hljs-attribute">renderer</span>": <span class="hljs-value"><span class="hljs-string">"./hello-renderer.js"</span></span>,
            "<span class="hljs-attribute">attributes</span>": <span class="hljs-value">{
                "<span class="hljs-attribute">name</span>": <span class="hljs-value"><span class="hljs-string">"string"</span></span>,
            }
        </span>}
    </span>}
</span>}
</code></pre>
<p><code>./ui-components/buttons/Button/raptor-tag.json</code></p>
<pre><code class="lang-json">{
    "<span class="hljs-attribute">renderer</span>": <span class="hljs-value"><span class="hljs-string">"./renderer"</span></span>,
    "<span class="hljs-attribute">attributes</span>": <span class="hljs-value">{
        "<span class="hljs-attribute">id</span>": <span class="hljs-value"><span class="hljs-string">"string"</span></span>,
        "<span class="hljs-attribute">label</span>": <span class="hljs-value"><span class="hljs-string">"string"</span></span>,
        "<span class="hljs-attribute">href</span>": <span class="hljs-value"><span class="hljs-string">"string"</span></span>,
        "<span class="hljs-attribute">variant</span>": <span class="hljs-value">{
            "<span class="hljs-attribute">type</span>": <span class="hljs-value"><span class="hljs-string">"string"</span></span>,
            "<span class="hljs-attribute">description</span>": <span class="hljs-value"><span class="hljs-string">"primary | info | success | warning | danger | inverse"</span> 
        </span>}</span>,
        "<span class="hljs-attribute">size</span>": <span class="hljs-value">{
            "<span class="hljs-attribute">type</span>": <span class="hljs-value"><span class="hljs-string">"string"</span></span>,
            "<span class="hljs-attribute">description</span>": <span class="hljs-value"><span class="hljs-string">"large | small | mini"</span>
        </span>}</span>,
        "<span class="hljs-attribute">toggle</span>": <span class="hljs-value"><span class="hljs-string">"boolean"</span></span>,
        "<span class="hljs-attribute">toggled</span>": <span class="hljs-value"><span class="hljs-string">"boolean"</span></span>,
        "<span class="hljs-attribute">dropdown</span>": <span class="hljs-value"><span class="hljs-string">"boolean"</span></span>,
        "<span class="hljs-attribute">id</span>": <span class="hljs-value">{
            "<span class="hljs-attribute">namespace</span>": <span class="hljs-value"><span class="hljs-string">"raptor-widgets"</span>
        </span>}</span>,
        "<span class="hljs-attribute">event-click</span>": <span class="hljs-value">{
            "<span class="hljs-attribute">namespace</span>": <span class="hljs-value"><span class="hljs-string">"raptor-widgets"</span>
        </span>}
    </span>}
</span>}
</code></pre>
<h3 id="simplified-asynchronous-api"><a name="simplified-asynchronous-api" class="anchor" href="#simplified-asynchronous-api"><span class="header-link"></span></a>Simplified asynchronous API</h3><pre><code class="lang-javascript">module.exports = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">render</span><span class="hljs-params">(input, context)</span> {</span>
    <span class="hljs-keyword">var</span> asyncContext = context.beginAsync();
    userService.loadUser(input.userId, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(err, userInfo)</span> {</span>
        asyncContext.write(<span class="hljs-string">'Hello '</span> + userInfo.name + <span class="hljs-string">'!'</span>);
        asyncContext.end();
    })
};
</code></pre>
<p>For more details, please see <a href="https://github.com/raptorjs3/raptor-templates#custom-taglibs">raptor-templates » README.md » Custom Taglibs</a>.</p>
</div><div class="post-footer"><div class="sharing"><a href="https://twitter.com/share" class="twitter-share-button" data-via="psteeleidem">Tweet</a><script>!function(d,s,id){var
js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document,
'script',
'twitter-wjs');</script></div><div class="post-nav"></div></div></article><section><h1>Comments</h1><div id="disqus_thread"></div><script type="text/javascript">var disqus_shortname = "psteeleidem";var disqus_identifier = "announcing-raptor-templates";var disqus_title = "Announcing the New Raptor Templates!"; (function() { var dsq = document.createElement('script'); dsq.type =
'text/javascript'; dsq.async = true; dsq.src = '//' + disqus_shortname +
'.disqus.com/embed.js'; (document.getElementsByTagName('head')[0] ||
document.getElementsByTagName('body')[0]).appendChild(dsq);
})();</script><noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript><a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a></section></main><aside id="sidebar"><div id="logo"><a href="http://psteeleidem.com/"><img src="/static/logo-b7524d72.jpg" alt="Patrick Steele-Idem"></a></div><p class="bio"><p>Web Developer with a passion for JavaScript and Node.js.</p>
<p>Senior Platform Architect at eBay.</p>
</p><p class="links"><a href="https://github.com/patrick-steele-idem"><i class="fa fa-github fa-2x"></i></a> <a href="https://twitter.com/psteeleidem"><i class="fa fa-twitter fa-2x"></i></a> <a href="https://www.npmjs.org/~pnidem"><img src="/static/npm-logo-7e4eb9dd.png"></a></p><section><h1>Projects</h1><ul><li><a href="https://github.com/raptorjs3/raptor-templates">Raptor Templates</a></li><li><a href="https://github.com/raptorjs3/raptor-optimizer">RaptorJS Optimizer</a></li><li><a href="https://github.com/patrick-steele-idem/freeze">Freeze</a></li></ul></section><section><h1>Explore</h1><ul></ul></section></aside><footer id="footer"><section id="footer-message">&copy; 2014 Patrick Steele-Idem. All rights reserved. Powered by <a href="https://github.com/patrick-steele-idem/freeze" target="_blank">Freeze</a>.</section></footer></div><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');
ga('create',
'UA-50307227-1', 'psteeleidem.com'); ga('send', 'pageview');</script></body></html>